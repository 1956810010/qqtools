{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{317:function(e,t,a){e.exports={toolsBox:\"_2OOgf\",tableBox:\"_3locr\",fl:\"_2If2e\",fr:\"_2v1iu\",mr10:\"_R-c_O\",ml10:\"_k05_a\",affix:\"_2kc2R\"}},320:function(e,t,a){\"use strict\";(function(e){a.d(t,\"d\",function(){return u}),a.d(t,\"a\",function(){return d}),a.d(t,\"f\",function(){return p}),a.d(t,\"e\",function(){return f}),a.d(t,\"g\",function(){return h}),a.d(t,\"b\",function(){return b}),a.d(t,\"c\",function(){return g});var n=a(328),o=a.n(n),r=a(327),i=a.n(r);const c=e.require(\"request\"),l={method:\"POST\",json:!0};function s(e){const t=\"QWERTYUIOPASDFGHJKLZXCVBNM1234567890\";let a=\"\";for(let n=0;n<e;n++){a+=t[Math.floor(Math.random()*t.length)]}return a}function m(e){return{\"Content-Type\":\"application/json;charset=utf-8\",appInfo:i()({vendor:\"apple\",deviceId:`${s(8)}-${s(4)}-${s(4)}-${s(4)}-${s(12)}`,appVersion:\"6.0.1\",appBuild:\"190420\",osVersion:\"11.4.1\",osType:\"ios\",deviceName:\"iPhone 6s\",os:\"ios\"}),\"User-Agent\":\"PocketFans201807/6.0.1 (iPhone; iOS 11.4.1; Scale/2.00)\",\"Accept-Language\":\"zh-Hans-AW;q=1\",Host:\"pocketapi.48.cn\",token:e}}function u(e,t){return new o.a((a,n)=>{c({...l,headers:m(),uri:\"https://pocketapi.48.cn/user/api/v1/login/app/mobile\",body:{mobile:e,pwd:t},gzip:!0,timeout:6e4},(e,t,o)=>{e?n(e):a(o)})}).catch(e=>{console.error(e)})}function d(e){return new o.a((t,a)=>{c({...l,headers:m(e),uri:\"https://pocketapi.48.cn/user/api/v1/friendships/friends/id\",body:{},gzip:!0,timeout:2e4},(e,n,o)=>{e?a(e):t(o)})}).catch(e=>{console.error(e)})}function p(e,t){return new o.a((a,n)=>{c({uri:\"https://pocketapi.48.cn/im/api/v1/chatroom/msg/list/homeowner\",method:\"POST\",headers:m(t),json:!0,body:{needTop1Msg:!1,roomId:e,nextTime:0},gzip:!0,timeout:2e4},(e,t,o)=>{e?n(e):a(o)})}).catch(e=>{console.error(e)})}function f(e,t,a){return new o.a((n,o)=>{c({uri:\"https://pocketapi.48.cn/idolanswer/api/idolanswer/v1/question_answer/detail\",method:\"POST\",headers:m(e),json:!0,body:{questionId:t,answerId:a},gzip:!0,timeout:2e4},(e,t,a)=>{e?o(e):n(a)})}).catch(e=>{console.error(e)})}function h(e){return new o.a((t,a)=>{c({uri:\"https://pocketapi.48.cn/im/api/v1/conversation/page\",method:\"POST\",headers:m(e),json:!0,body:{targetType:0},gzip:!0,timeout:6e4},(e,n,o)=>{e?a(e):t(o)})}).catch(e=>{console.error(e)})}function b(e){return new o.a((t,a)=>{c({uri:\"https://pocketapi.48.cn/live/api/v1/live/getLiveOne\",method:\"POST\",headers:m(),json:!0,body:{liveId:e}},function(e,n,o){e?a(e):t(o)})})}function g(e=0,t=!1){return new o.a((a,n)=>{const o={debug:!0,next:e};t&&(o.groupId=0,o.record=!1),c({uri:\"https://pocketapi.48.cn/live/api/v1/live/getLiveList\",method:\"POST\",headers:m(),json:!0,body:o},function(e,t,o){e?n(e):a(o)})})}}).call(this,a(27))},324:function(e,t,a){\"use strict\";var n=a(299),o=a(0),r=a.n(o),i=a(1),c=a.n(i);t.a=function(e){return function(t){var a,i;return i=a=class extends o.Component{constructor(){var t;super(...arguments);const a=(null==this?void 0:null===(t=this.props)||void 0===t?void 0:t.injectReducers)||null;a&&a(e)}render(){return r.a.createElement(t,null)}},Object(n.a)(a,\"propTypes\",{injectReducers:c.a.func}),i}}},373:function(e,t,a){e.exports={box:\"_3PTEx\",body:\"_2g1IU\",inforP:\"_2cqS_\",mb10:\"_36SyC\",keyName:\"_11RdS\",mr20:\"_1AwO2\",loadingText:\"_Z71jO\",searchId:\"_kAmOG\",searchGroup:\"_w3N8f\",searchText:\"_32Z79\",infoBox:\"_1rg2z\",infoTable:\"_3bl3U\"}},622:function(e,t,a){e.exports=a(623)},623:function(e,t,a){e.exports=a(624)},624:function(e,t,a){var n=a(625),o=Array.prototype;e.exports=function(e){var t=e.concat;return e===o||e instanceof Array&&t===o.concat?n:t}},625:function(e,t,a){a(626),e.exports=a(68)(\"Array\").concat},626:function(e,t,a){\"use strict\";var n=a(163),o=a(41),r=a(105),i=a(100),c=a(169),l=a(174),s=a(96)(\"isConcatSpreadable\"),m=!a(22)(function(){var e=[];return e[s]=!1,e.concat()[0]!==e}),u=a(164)(\"concat\"),d=function(e){if(!o(e))return!1;var t=e[s];return void 0!==t?!!t:n(e)},p=!m||!u;a(49)({target:\"Array\",proto:!0,forced:p},{concat:function(e){var t,a,n,o,s,m=r(this),u=l(m,0),p=0;for(t=-1,n=arguments.length;t<n;t++)if(s=-1===t?m:arguments[t],d(s)){if(p+(o=i(s.length))>9007199254740991)throw TypeError(\"Maximum allowed index exceeded\");for(a=0;a<o;a++,p++)a in s&&c(u,p,s[a])}else{if(p>=9007199254740991)throw TypeError(\"Maximum allowed index exceeded\");c(u,p++,s)}return u.length=p,u}})},635:function(e,t,a){\"use strict\";a.r(t);var n=a(0),o=a.n(n),r=a(32),i=a(324),c=a(636),l=a(633),s=a(43),m=a(110),u=a(167);const d={objectStoreName:m.a.indexeddb.objectStore[2].name},p={objectStoreName:m.a.indexeddb.objectStore[1].name},f=Object(c.a)(\"登录信息\"),h=u.a.getAction({...d,successAction:f}),b=u.a.putAction({...d,successAction:f}),g=u.a.clearAction(d),v=u.a.getAction(p),I=u.a.addAction(p),E=u.a.cursorAction(p),y=u.a.clearAction(p);var k={kouDai48:Object(l.a)({[f]:(e,t)=>{const a=\"data\"in t.payload?t.payload.data:t.payload.result;return e.set(\"loginInformation\",a||null)}},Object(s.fromJS)({loginInformation:null}))},w=(a(176),a(121)),x=(a(341),a(339)),N=(a(177),a(48)),j=(a(303),a(300)),O=(a(307),a(311)),S=(a(330),a(342)),T=(a(343),a(331)),P=(a(304),a(302)),_=a(52),A=a.n(_),C=a(363),M=a.n(C),D=(a(372),a(375)),R=a(370),B=a.n(R),L=a(328),q=a.n(L),z=(a(319),a(322)),F=a(299),J=(a(308),a(310)),$=a(622),G=a.n($),U=a(1),H=a.n(U),K=a(34),V=a(102),Z=a(7),Q=a(316),W=a(3),X=a.n(W),Y=a(317),ee=a.n(Y),te=a(373),ae=a.n(te);var ne,oe,re,ie=function(e){var t,a;const n=e.loginInformation;return o.a.createElement(j.a,{title:\"登录信息\"},n?[o.a.createElement(\"p\",{key:\"0\",className:ae.a.inforP},\"ID: \",null==n?void 0:null===(t=n.userInfo)||void 0===t?void 0:t.userId),o.a.createElement(\"p\",{key:\"1\",className:ae.a.inforP},\"昵称: \",null==n?void 0:null===(a=n.userInfo)||void 0===a?void 0:a.nickname),o.a.createElement(\"p\",{key:\"2\",className:ae.a.inforP},\"Token: \",null==n?void 0:n.token)]:o.a.createElement(\"p\",null,\"暂无登录记录\"))};const ce=Object(Q.b)({});var le,se,me,ue=Object(V.b)(ce,e=>({action:Object(K.b)({getMemberInformation:v,addMemberInformation:I},e)}))((re=oe=class extends n.Component{findRoomIdByMemberId(e){const{roomPage:t=[]}=this.props;let a=null,n=null;for(const o of t)if(e===Number(o.ownerId)){a=o.targetId,n=o.ownerName;break}return{id:a,name:n}}render(){const{item:e}=this.props,{name:t,id:a}=this.findRoomIdByMemberId(Number(e.memberId));return e?\"\"!==t?[o.a.createElement(\"b\",{key:\"0\",className:ae.a.keyName},\"memberName:\"),o.a.createElement(\"span\",{key:\"1\",className:ae.a.mr20},t||\"---\"),o.a.createElement(\"b\",{key:\"2\",className:ae.a.keyName},\"roomId:\"),o.a.createElement(\"span\",{key:\"3\"},a||\"---\")]:null:o.a.createElement(\"span\",{className:ae.a.loadingText},\"加载中...\")}},Object(F.a)(oe,\"propTypes\",{item:H.a.object,roomPage:H.a.array}),ne=re))||ne,de=a(320);function pe(e,t,a){if(0===e.length)return[];if(t===a)return[{memberId:e[t]}];const n=Math.floor((a-t)/2)+t,o=pe(e,t,n),r=pe(e,n+1,a);return G()(o).call(o,r)}const fe=Object(Q.b)({loginInformation:Object(Q.a)(e=>e.has(\"kouDai48\")?e.get(\"kouDai48\"):null,e=>null!==e?e.get(\"loginInformation\"):null)});var he,be=J.a.create()(le=Object(V.b)(fe,e=>({action:Object(K.b)({loginInformation:f,getLoginInformation:h,putLoginInformation:b,cursorMemberInformation:E,clearLoginInformation:g,clearMemberInformation:y},e)}))((me=se=class extends n.Component{constructor(){super(...arguments),this.state={searchString:\"\",searchResult:[]}}componentDidMount(){this.props.action.getLoginInformation({query:\"loginInformation\"})}columns(){var e,t,a;const n=(null===(e=this.props)||void 0===e?void 0:null===(t=e.loginInformation)||void 0===t?void 0:null===(a=t.value)||void 0===a?void 0:a.roomPage)||[];return[{title:\"memberId\",dataIndex:\"memberId\",key:\"memberId\",width:\"20%\"},{title:\"information\",key:\"information\",width:\"80%\",render:(e,t,a)=>o.a.createElement(ue,{item:t,roomPage:n})}]}handleSubmit(e){e.preventDefault(),this.props.form.validateFields(async(e,t)=>{if(!e)try{const a=await Object(de.d)(t.account,t.password);if(200!==a.status)return void z.a.warn(a.message);const{content:n}=a,o=n.token||n.userInfo.token,[r,i]=await q.a.all([Object(de.a)(o),Object(de.g)(o)]),c={key:\"loginInformation\",value:{friends:r.content.data,token:o,userInfo:n.userInfo,roomPage:i.content.conversations}};await this.props.action.putLoginInformation({data:c}),this.props.form.resetFields(),z.a.success(\"登陆成功！\")}catch(e){z.a.error(\"登陆失败！\"),console.error(e)}})}handleInputChange(e){this.setState({searchString:e.target.value})}findRoomIdByMemberId(e){var t,a,n;const o=(null===(t=this.props)||void 0===t?void 0:null===(a=t.loginInformation)||void 0===a?void 0:null===(n=a.value)||void 0===n?void 0:n.roomPage)||[],r=[];for(const c of o){var i;B()(i=c.ownerName).call(i,e)&&r.push(c)}return r}handleSearchInformationClick(e){const{searchString:t}=this.state,a=this.findRoomIdByMemberId(t);a&&a.length>0?D.a.info({title:\"搜索结果\",centered:!0,content:o.a.createElement(\"div\",{className:ae.a.infoBox},o.a.createElement(\"table\",{className:ae.a.infoTable},o.a.createElement(\"thead\",null,o.a.createElement(\"tr\",null,o.a.createElement(\"th\",null,\"小偶像名字\"),o.a.createElement(\"th\",null,\"小偶像ID\"),o.a.createElement(\"th\",null,\"房间ID\"))),o.a.createElement(\"tbody\",null,M()(a).call(a,(e,t)=>o.a.createElement(\"tr\",{key:e.ownerId},o.a.createElement(\"td\",null,e.ownerName),o.a.createElement(\"td\",null,e.ownerId),o.a.createElement(\"td\",null,e.targetId))))))}):z.a.info(\"没有数据\")}async handleExitAndClearClick(e){try{await this.props.action.clearLoginInformation(),await this.props.action.clearMemberInformation(),this.props.action.loginInformation({data:null})}catch(t){console.error(t)}}render(){var e,t,a,r,i,c;const{getFieldDecorator:l}=this.props.form,s=this.props.loginInformation,m=[];return M()(e=this.state.searchResult).call(e,(e,t)=>{m.push(o.a.createElement(\"div\",{key:e.memberId,className:ae.a.searchGroup},o.a.createElement(\"p\",{className:ae.a.searchText},\"memberId: \",e.memberId),o.a.createElement(\"p\",{className:ae.a.searchText},\"memberName: \",e.memberName),o.a.createElement(\"p\",{className:ae.a.searchText},\"roomId: \",e.roomId)))}),o.a.createElement(n.Fragment,null,o.a.createElement(S.a,{className:ee.a.affix},o.a.createElement(\"div\",{className:X()(ee.a.toolsBox,\"clearfix\")},o.a.createElement(\"div\",{className:ee.a.fr},o.a.createElement(T.a,{title:\"确定退出登录并清除缓存吗？\",onConfirm:A()(t=this.handleExitAndClearClick).call(t,this)},o.a.createElement(P.a,{icon:\"warning\"},\"退出登录并清除缓存\")),o.a.createElement(Z.b,{className:ee.a.ml10,to:\"/\"},o.a.createElement(P.a,{type:\"danger\",icon:\"poweroff\"},\"返回\"))))),o.a.createElement(\"div\",{className:ae.a.box},o.a.createElement(w.a,{className:ae.a.body,gutter:10},o.a.createElement(N.a,{span:12},o.a.createElement(j.a,{className:ae.a.mb10,title:\"口袋48登录\"},o.a.createElement(\"p\",{className:ae.a.mb10},\"在使用口袋48的房间监听功能前，必须先登录，获取token，否则无法获取到房间信息。\"),o.a.createElement(\"p\",{className:ae.a.mb10},\"登录一次后，token会储存在本地，不需要重复登录。\"),o.a.createElement(J.a,{onSubmit:A()(a=this.handleSubmit).call(a,this)},o.a.createElement(J.a.Item,{label:\"用户名\"},l(\"account\",{rules:[{message:\"必须输入用户名\",required:!0,whitespace:!0}]})(o.a.createElement(O.a,null))),o.a.createElement(J.a.Item,{label:\"密码\"},l(\"password\",{rules:[{message:\"必须输入密码\",required:!0,whitespace:!0}]})(o.a.createElement(O.a.Password,null))),o.a.createElement(P.a,{type:\"primary\",htmlType:\"submit\"},\"登录\"))),o.a.createElement(ie,{loginInformation:s?s.value:null})),o.a.createElement(N.a,{span:12},o.a.createElement(j.a,{className:ae.a.mb10,title:\"ID搜索\"},o.a.createElement(\"div\",null,o.a.createElement(\"label\",{htmlFor:\"koudai48-search\"},\"在数据库中搜索小偶像的相关信息，请输入小偶像的名字：\"),o.a.createElement(O.a,{className:ae.a.searchId,id:\"koudai48-search\",value:this.state.searchString,onChange:A()(r=this.handleInputChange).call(r,this),onPressEnter:A()(i=this.handleSearchInformationClick).call(i,this)}),o.a.createElement(P.a,{className:ee.a.ml10,type:\"primary\",onClick:A()(c=this.handleSearchInformationClick).call(c,this)},\"搜索\"),m)),o.a.createElement(x.a,{columns:this.columns(),size:\"middle\",rowKey:e=>e.memberId,bordered:!0,dataSource:s?pe(s.value.friends,0,s.value.friends.length-1):[],pagination:{defaultPageSize:10,showQuickJumper:!0}})))))}},Object(F.a)(se,\"propTypes\",{loginInformation:H.a.object,action:H.a.objectOf(H.a.func),form:H.a.object}),le=me))||le)||le;let ge=Object(i.a)(k)(he=class extends n.Component{render(){return o.a.createElement(r.c,null,o.a.createElement(r.a,{path:\"/KouDai48\",component:be,exact:!0}))}})||he;t.default=ge}}]);","extractedComments":[]}